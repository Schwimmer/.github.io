<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222"/>






















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0"/>

<link rel="stylesheet" href="/css/main.css?v=7.2.0"/>


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.2.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Record and Think!">
<meta property="og:type" content="website">
<meta property="og:title" content="Schwimmer&#39;s Blog">
<meta property="og:url" content="https://schwimmer.github.io/page/3/index.html">
<meta property="og:site_name" content="Schwimmer&#39;s Blog">
<meta property="og:description" content="Record and Think!">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Schwimmer&#39;s Blog">
<meta name="twitter:description" content="Record and Think!">





  
  
  <link rel="canonical" href="https://schwimmer.github.io/page/3/"/>



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Schwimmer's Blog</title>
  




  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-143240576-1"></script>
  <script>
    var host = window.location.hostname;
    if (host !== "localhost" || !true) {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-143240576-1');
    }
  </script>









  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Schwimmer's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br/>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br/>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br/>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br/>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br/>搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://schwimmer.github.io/2019/06/19/编程语言学习/SCALA/TOP K问题/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Schwimmer"/>
      <meta itemprop="description" content="Record and Think!"/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Schwimmer's Blog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/19/编程语言学习/SCALA/TOP K问题/" class="post-title-link" itemprop="url">未命名</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-19 17:22:56 / 修改时间：17:23:57" itemprop="dateCreated datePublished" datetime="2019-06-19T17:22:56+08:00">2019-06-19</time>
            </span>
          

          
            

            
          

          

          
            
            
              
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/06/19/编程语言学习/SCALA/TOP K问题/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/19/编程语言学习/SCALA/TOP K问题/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          <br/>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Spark-TopK-问题解决-使用最小堆"><a href="#Spark-TopK-问题解决-使用最小堆" class="headerlink" title="Spark TopK 问题解决-使用最小堆"></a>Spark TopK 问题解决-使用最小堆</h1><p><a href="https://blog.csdn.net/yuzx2008/article/details/50732151" target="_blank" rel="noopener">https://blog.csdn.net/yuzx2008/article/details/50732151</a></p>
<p>整个排序取 TopK 的实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">object TopK0 &#123;</div><div class="line"></div><div class="line">  val K = 3</div><div class="line"></div><div class="line">  def main(args: Array[String]) &#123;</div><div class="line">    // 执行 wordcount</div><div class="line">    val conf = new SparkConf().setAppName(&quot;TopK0&quot;)</div><div class="line">    val spark = new SparkContext(conf)</div><div class="line">    val textRDD = spark.textFile(&quot;hdfs://10.0.8.162:9000/home/yuzx/input/wordcount.txt&quot;)</div><div class="line">    textRDD.flatMap(line =&gt; line.split(&quot; &quot;))</div><div class="line">      .map(word =&gt; (word, 1))</div><div class="line">      .reduceByKey(_ + _)</div><div class="line">      .map &#123; pair =&gt; pair.swap &#125;</div><div class="line">      .sortByKey(true, 2)</div><div class="line">      .top(3)</div><div class="line">      .foreach(println)</div><div class="line"></div><div class="line">    spark.stop()</div><div class="line"></div><div class="line">  &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>基于最小堆的实现：</p>
<p>最大/小堆，对应的数据结构优先级队列，PriorityQueue，不光 Java 中有，Scala 中也有，当然 c++ 中也有</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">TopK</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">val</span> <span class="type">K</span> = <span class="number">3</span></div><div class="line"></div><div class="line">  <span class="keyword">val</span> ord = <span class="type">Ordering</span>.by[(<span class="type">String</span>, <span class="type">Int</span>), <span class="type">Int</span>](_._2).reverse</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]) &#123;</div><div class="line">    <span class="comment">// 执行 wordcount</span></div><div class="line">    <span class="keyword">val</span> conf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setAppName(<span class="string">"TopK"</span>)</div><div class="line">    <span class="keyword">val</span> spark = <span class="keyword">new</span> <span class="type">SparkContext</span>(conf)</div><div class="line">    <span class="keyword">val</span> textRDD = spark.textFile(<span class="string">"hdfs://10.0.8.162:9000/home/yuzx/input/wordcount.txt"</span>)</div><div class="line">    <span class="keyword">val</span> countRes = textRDD.flatMap(line =&gt; line.split(<span class="string">" "</span>)).map(word =&gt; (word, <span class="number">1</span>)).reduceByKey(_ + _)</div><div class="line"></div><div class="line">    <span class="comment">// debug mapreduce 的结果</span></div><div class="line">    countRes.foreach(println)</div><div class="line"></div><div class="line">    <span class="comment">/*</span></div><div class="line">     每个 RDD 分区内进行 TOP K 计算</div><div class="line">     需要每个分区内有自己的桶，如果整个程序使用一个 heap（将 heap 设定为成员变量） 会不正确</div><div class="line">     为什么呢？</div><div class="line">      */</div><div class="line">    <span class="keyword">val</span> topk = countRes.mapPartitions(iter =&gt; &#123;</div><div class="line">      <span class="keyword">val</span> heap = <span class="keyword">new</span> mutable.<span class="type">PriorityQueue</span>[(<span class="type">String</span>, <span class="type">Int</span>)]()(ord)</div><div class="line">      <span class="keyword">while</span> (iter.hasNext) &#123;</div><div class="line">        <span class="keyword">val</span> n = iter.next</div><div class="line">        println(<span class="string">"分区计算："</span> + n)</div><div class="line">        putToHeap(heap, n)</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      heap.iterator</div><div class="line">    &#125;).collect()</div><div class="line"></div><div class="line">    println(<span class="string">"分区结果："</span>)</div><div class="line">    topk.foreach(println)</div><div class="line"></div><div class="line">    <span class="comment">// 每个分区的 TOP K 合并，计算总的 TopK</span></div><div class="line">    <span class="keyword">val</span> heap = <span class="keyword">new</span> mutable.<span class="type">PriorityQueue</span>[(<span class="type">String</span>, <span class="type">Int</span>)]()(ord)</div><div class="line">    <span class="keyword">val</span> iter = topk.iterator</div><div class="line">    <span class="keyword">while</span> (iter.hasNext) &#123;</div><div class="line">      putToHeap(heap, iter.next)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    println(<span class="string">"最终结果："</span>)</div><div class="line">    <span class="keyword">while</span> (heap.nonEmpty) &#123;</div><div class="line">      println(heap.dequeue())</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    spark.stop()</div><div class="line"></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">putToHeap</span></span>(heap: mutable.<span class="type">PriorityQueue</span>[(<span class="type">String</span>, <span class="type">Int</span>)], iter: (<span class="type">String</span>, <span class="type">Int</span>)): <span class="type">Unit</span> = &#123;</div><div class="line">    <span class="keyword">if</span> (heap.nonEmpty &amp;&amp; heap.size &gt;= <span class="type">K</span>) &#123;</div><div class="line">      <span class="keyword">if</span> (heap.head._2 &lt; iter._2) &#123;</div><div class="line">        heap += iter</div><div class="line">        heap.dequeue()</div><div class="line">      &#125;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      heap += iter</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://schwimmer.github.io/2019/06/19/地理信息挖掘/基于轨迹数据的团体挖掘/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Schwimmer"/>
      <meta itemprop="description" content="Record and Think!"/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Schwimmer's Blog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/19/地理信息挖掘/基于轨迹数据的团体挖掘/" class="post-title-link" itemprop="url">未命名</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-19 09:52:44 / 修改时间：10:23:08" itemprop="dateCreated datePublished" datetime="2019-06-19T09:52:44+08:00">2019-06-19</time>
            </span>
          

          
            

            
          

          

          
            
            
              
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/06/19/地理信息挖掘/基于轨迹数据的团体挖掘/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/19/地理信息挖掘/基于轨迹数据的团体挖掘/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          <br/>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://blog.csdn.net/weixin_42449669/article/details/87978320" target="_blank" rel="noopener">https://blog.csdn.net/weixin_42449669/article/details/87978320</a></p>
<p>轨迹数据挖掘介绍<br>轨迹挖掘分为伴随模式挖掘、频繁模式挖掘、周期模式挖掘等不同种类。</p>
<p>伴随模式挖掘是在轨迹数据中提取伴随的移动对象，通过分析移动对象群体的行为特征和规律，可以发现时空环境中的群体。典型的伴随模式有ｆｌｏｃｋ、ｃｏｎｖｏｙ、ｇａｔｈｅｒｉｎｇ等。<br>频繁模式挖掘是从大规模轨迹数据中发现频繁时序模式，例如挖掘公共性规律或公共性频繁路径等。一般来说轨迹数据中包含了位置、时间和语义信息，所以时空轨迹频繁模式挖掘与传统的频繁序列挖掘有一定的区别。频繁模式挖掘在生活模式挖掘、地点预测、用户相似性估计等方面有很多应用。<br>移动对象经常有一些周期性的活动行为，例如购物行为、动物的定期迁移行为等，通过挖掘此类轨迹可以预测移动对象未来的行为。一般将周期模式挖掘分为完全周期模式、部分周期模式、同步周期模式、异步周期模式等。<br>伴随关系分析将采用伴随模式挖掘。<br>伴随模式挖掘相关算法<br>轨迹相似度度量算法<br>比较经典的轨迹相似度计算方法有最长公共子序列（LCSS）、编辑距离（ED）、动态时间规整（DTW）等</p>
<p>DTW：<br>将时间序列进行延伸和缩短，来计算两个时间序列性之间的相似性，将两条轨迹上的所有点进行匹配，每个点都会匹配到另一条轨迹上距离最近的点，并且同一个点可以被另一条轨迹上的多个点所匹配。</p>
<p>LCSS：<br>无需匹配所有点计算相似度的情况下，可以用LCSS算法进行相似度计算，该算法可以使用动态规划的思想实现。但该算法在低精度轨迹数据集上，导致两条轨迹上只有很少的点能够匹配上，大部分的点无法匹配，导致相似度计算结果偏低。</p>
<p>ED：<br>是指两个字符串之间，由一个转成另一个所需的最少编辑次数。但是时间复杂度很高。</p>
<p>基于以上提到的轨迹相似度计算方法，还有一种基于轨迹形状的轨迹相似度计算方法，使用轨迹点的方向向量替代具体坐标计算相似度，该算法更倾向于关注轨迹的整体形状，而不是轨迹点之间的距离。<br>以上算法需要高精度的轨迹数据集、时间复杂度高，需要一种算法来针对低精度的稀疏的轨迹数据集，基于相似度计算的团体识别算法GMPMS (Group Movement Pattern Mining based on Similarity)。<br>轨迹数据降噪处理<br>由于设备原因或者信号问题造成的轨迹数据错误采样产生了噪声点。噪声点影响后续的轨迹挖掘与分析，因此需要首先过滤掉。一般来说有中值滤波、卡尔曼滤波与粒子滤波３种方式处理噪声点，其主要思想是通过前ｎ个点的位置预测当前点的位置，通过预测值对当前点的位置进行合理修正，达到轨迹平滑的效果。</p>
<p>计算的时间复杂度<br>为了减少两两计算相似度的复杂度，使用频繁项集挖掘, 发掘候选团体。候选团体发现的思想是从时间和空间两个纬度对用户轨迹进行切分,找出经常在同一时间出现在同一区域的候选团体,将这些团体的集合作为候选集。</p>
<p>基于相似度计算的团体识别算法GMPMS<br>数据预处理<br>数据降噪，去除噪声点（偏差较大的数据）<br>轨迹点聚合。将每个用户的轨迹分为停留点和路过点, 停留点: 时间相差15min, 距离相差200m的点的集合。聚合结果如图所示</p>
<p>p2和p3的聚合为一个点sp1，sp1的地理坐标用所有点的平均值，时间使用p2的时间作为sp1的起始时间，并且计算出sp1的停留时间，停留时间越长代表该点越重要。</p>
<p>时空轨迹快照<br>时空轨迹快照的目的是为了减少轨迹两两计算的时间复杂度</p>
<p>按时间切分<br>按照时间将轨迹数据切分为连续的时间快照，快照的时间间隔为T，轨迹稀疏时，T值要设置大些。如下图所示</p>
<pre><code>                                                                   图3-2

                                       S表示时间片，C表示时间片中的簇
</code></pre><p>按照空间切分<br>轨迹数据被切分成时间快照后，在每个快照中使用基于密度聚类的方法（ＤＢＳＣＡＮ）来进行聚类，得到每个快照中的轨迹簇，每个时间快照可能有一个或多个簇，为接下来候选团体的发现做准备。如图3-2中，C5,1和C5,2是时间片S5中的两个轨迹簇。</p>
<p>候选团体发现<br>参考“购物车分析”<br>“购物车分析”是数据挖掘领域中，关联规则分析的一个经典问题，其目的是从零售记录中分析出顾客经常同时购买商品的组合，挖掘出购物篮中有价值的信息。举例来说，人们经常会同时购买面包和黄油，因此这两种物品会频繁出现在同一购物清单上。通过机器学习中的频繁项集挖掘的方法可以将具有关联的物品组合找出来。</p>
<p>轨迹分析与“购物车分析”对比<br>以上提到的轨迹簇类似与电商中的购物车,轨迹簇中的人相当于有关联的物品。</p>
<p>采用频繁项集挖掘算法FP-growth并设置合适的阈值K和M，可以得到候选轨迹簇的集合。FP-growth算法可以在快照的轨迹簇中挖掘满足团体最小人数M和最少出现次数K的集合，并且对于集合出现次数的连续性没有限制。该算法只需要对数据集进行两次扫描即可得出频繁项集的结果，时间复杂度很低。FP-growth算法分为构建ＦＰ树和挖掘频繁项集两个步骤。<br>相似性度量<br>通过计算候选团体内，每个人之间的轨迹相似度Tsim。<br>采用基于轨迹质心距离的相似度计算方法，该算法更适合低经度下的轨迹相似度计算。<br>找出两条轨迹上的匹配点，将轨迹按照匹配点切分成子轨迹。之后，对于每段子轨迹，计算其轨迹上所有点的质心坐标，对比两个轨迹的质心距离，如果质心距离在阀值之内，则认为子轨迹相似。这个算法将子轨迹段上一系列的聚合为质心进行计算，减小了轨迹点不同数量和异常点造成的影响。<br>两条轨迹总相似度S=m/n, m是相似的子轨迹, n是子轨迹的数量<br>团体识别<br>通过人之间的相似度判断是否属于伴随关系，如果存在伴随关系，则认为这两个人之间存在着边相连，在一个候选集中，将存在边的人划分为同一个群体，因此一个候选集内可能存在一个或多个伴随团体。</p>
<p>基于相似度阀值的关系判别, 通过人工指定阀值，阀值需要在具体实践中调整, 适用于大团体识别<br>基于半监督学习的关系判别, 适用于小团体识别<br>参数设置</p>
<p>候选团体最小人数为2, 最少出现次数为4. 轨迹点匹配时间阀值5min, 轨迹点匹配距离阀值是1km, 子轨迹段相似的质心距离小于1km, 轨迹相似度阀值为0.5</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://schwimmer.github.io/2019/06/18/深度学习笔记/深度学习入门/CH3 神经网络/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Schwimmer"/>
      <meta itemprop="description" content="Record and Think!"/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Schwimmer's Blog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/18/深度学习笔记/深度学习入门/CH3 神经网络/" class="post-title-link" itemprop="url">未命名</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-18 08:33:06 / 修改时间：09:28:14" itemprop="dateCreated datePublished" datetime="2019-06-18T08:33:06+08:00">2019-06-18</time>
            </span>
          

          
            

            
          

          

          
            
            
              
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/06/18/深度学习笔记/深度学习入门/CH3 神经网络/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/18/深度学习笔记/深度学习入门/CH3 神经网络/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          <br/>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>代码在</p>
<p><code>/Users/david/david/git/dl/deep-learning-from-scratch</code></p>
<h1 id="激活函数"><a href="#激活函数" class="headerlink" title="激活函数"></a>激活函数</h1><h2 id="sigmoid"><a href="#sigmoid" class="headerlink" title="sigmoid"></a>sigmoid</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">def sigmoid(x):</div><div class="line">	return 1 / (1 + np.exp(-x))</div></pre></td></tr></table></figure>
<p>x可以是标量，可以是np.array</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://schwimmer.github.io/2019/06/18/深度学习笔记/深度学习入门/CH2 感知机/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Schwimmer"/>
      <meta itemprop="description" content="Record and Think!"/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Schwimmer's Blog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/18/深度学习笔记/深度学习入门/CH2 感知机/" class="post-title-link" itemprop="url">未命名</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-18 08:19:36 / 修改时间：08:31:50" itemprop="dateCreated datePublished" datetime="2019-06-18T08:19:36+08:00">2019-06-18</time>
            </span>
          

          
            

            
          

          

          
            
            
              
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/06/18/深度学习笔记/深度学习入门/CH2 感知机/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/18/深度学习笔记/深度学习入门/CH2 感知机/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          <br/>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>代码在</p>
<p><code>/Users/david/david/git/dl/deep-learning-from-scratch</code></p>
<p>实现与门、与非门和或门，在此基础上实现了感知机。</p>
<p>与门、与非门和或门 与感知机的思想的类似的，对任意的输入，最终变成0和1的输出，在输入到输出的时候还会带上权重和偏置。</p>
<h1 id="感知机和异或门"><a href="#感知机和异或门" class="headerlink" title="感知机和异或门"></a>感知机和异或门</h1><p>感知机的局限性，单层感知机是无法实现<strong>异或门</strong>的。</p>
<p>why？</p>
<p>比如与门、与非门和或门，在空间的划分都是直线，例如</p>
<p><img src="/2019/06/18/深度学习笔记/深度学习入门/CH2 感知机/pic/image-20190618082700331.png" alt="image-20190618082700331"></p>
<p>可以用单层感知机实现对0和1的分类，只要定义好公式和权重。</p>
<p>而异或门对于空间的划分</p>
<p><img src="/2019/06/18/深度学习笔记/深度学习入门/CH2 感知机/pic/image-20190618082714611.png" alt="image-20190618082714611"></p>
<p>是非线性的。</p>
<p><img src="/2019/06/18/深度学习笔记/深度学习入门/CH2 感知机/pic/image-20190618082736756.png" alt="image-20190618082736756"></p>
<p>若要实现异或门，必须上多层感知机。</p>
<p><img src="/2019/06/18/深度学习笔记/深度学习入门/CH2 感知机/pic/image-20190618082808824.png" alt="image-20190618082808824"></p>
<p><img src="/2019/06/18/深度学习笔记/深度学习入门/CH2 感知机/pic/image-20190618082816721.png" alt="image-20190618082816721"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">XOR</span><span class="params">(x1, x2)</span>:</span></div><div class="line">    s1 = NAND(x1, x2)</div><div class="line">    s2 = OR(x1, x2)</div><div class="line">    y = AND(s1, s2)</div><div class="line">    <span class="keyword">return</span> y</div></pre></td></tr></table></figure>
<p>P59</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://schwimmer.github.io/2019/06/16/算法与数据结构/LeeCode/week4-1 验证二叉搜索树/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Schwimmer"/>
      <meta itemprop="description" content="Record and Think!"/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Schwimmer's Blog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/16/算法与数据结构/LeeCode/week4-1 验证二叉搜索树/" class="post-title-link" itemprop="url">未命名</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-16 14:53:50 / 修改时间：15:30:35" itemprop="dateCreated datePublished" datetime="2019-06-16T14:53:50+08:00">2019-06-16</time>
            </span>
          

          
            

            
          

          

          
            
            
              
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/06/16/算法与数据结构/LeeCode/week4-1 验证二叉搜索树/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/16/算法与数据结构/LeeCode/week4-1 验证二叉搜索树/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          <br/>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://blog.csdn.net/qq_30490125/article/details/53135274" target="_blank" rel="noopener">https://blog.csdn.net/qq_30490125/article/details/53135274</a></p>
<p>错误解答</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">isValidBST</span><span class="params">(self, root: TreeNode)</span> -&gt; bool:</span></div><div class="line">    <span class="keyword">if</span> root <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">    <span class="keyword">if</span> root.left <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span> <span class="keyword">and</span> root.left.val &gt; root.val:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">    <span class="keyword">if</span> root.right <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span> <span class="keyword">and</span> root.right.val &lt; root.val:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> self.isValidBST(root.left) <span class="keyword">or</span> <span class="keyword">not</span> self.isValidBST(root.right):</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">True</span></div></pre></td></tr></table></figure>
<p>反例</p>
<p><img src="/2019/06/16/算法与数据结构/LeeCode/week4-1 验证二叉搜索树/pic/image-20190616145426312.png" alt="image-20190616145426312"></p>
<p>方法1：</p>
<p>中序遍历，判断是否是升序</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://schwimmer.github.io/2019/06/16/机器学习和深度学习算法理论/逻辑回归/损失函数-交叉熵/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Schwimmer"/>
      <meta itemprop="description" content="Record and Think!"/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Schwimmer's Blog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/16/机器学习和深度学习算法理论/逻辑回归/损失函数-交叉熵/" class="post-title-link" itemprop="url">未命名</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-16 09:53:53 / 修改时间：10:00:56" itemprop="dateCreated datePublished" datetime="2019-06-16T09:53:53+08:00">2019-06-16</time>
            </span>
          

          
            

            
          

          

          
            
            
              
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/06/16/机器学习和深度学习算法理论/逻辑回归/损失函数-交叉熵/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/16/机器学习和深度学习算法理论/逻辑回归/损失函数-交叉熵/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          <br/>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://blog.csdn.net/syyyy712/article/details/78252722" target="_blank" rel="noopener">逻辑回归算法之交叉熵函数理解</a></p>
<p>对于LR的函数</p>
<blockquote>
<p>怎么叫什么函数，输出函数？模型函数？</p>
</blockquote>
<p><img src="/2019/06/16/机器学习和深度学习算法理论/逻辑回归/损失函数-交叉熵/pic/SouthEast.png" alt="è¿éåå¾çæè¿°"></p>
<p>如果我们采用传统的平方误差函数，其画出的代价函数图<strong>就不会是一个凸函数</strong>，而是有很多局部最优点的歪歪扭扭的函数图像如下： </p>
<blockquote>
<p>为什么？</p>
</blockquote>
<p><img src="/2019/06/16/机器学习和深度学习算法理论/逻辑回归/损失函数-交叉熵/pic/SouthEast-20190616095710926.png" alt="è¿éåå¾çæè¿°"></p>
<p>这类函数图像不是我们所想要的，因为有太多局部最优点了，我们需要一个全局最优点并且曲线光滑，如下图是我们所想要得到的代价函数曲线图 </p>
<p><img src="/2019/06/16/机器学习和深度学习算法理论/逻辑回归/损失函数-交叉熵/pic/SouthEast-20190616095728402.png" alt="è¿éåå¾çæè¿°"></p>
<p>为了达到尽可能使得曲线光滑以及尽可能使得类似于像这种一元二次函数，因此我们给出代价函数表达式如下表示：</p>
<p><img src="/2019/06/16/机器学习和深度学习算法理论/逻辑回归/损失函数-交叉熵/pic/SouthEast-20190616095758497.png" alt="è¿éåå¾çæè¿°"></p>
<p><img src="/2019/06/16/机器学习和深度学习算法理论/逻辑回归/损失函数-交叉熵/pic/SouthEast-20190616095835034.png" alt="è¿éåå¾çæè¿°"></p>
<p><img src="/2019/06/16/机器学习和深度学习算法理论/逻辑回归/损失函数-交叉熵/pic/SouthEast-20190616095841664.png" alt="è¿éåå¾çæè¿°"></p>
<p>这个代价函数是一个分段函数，分别给出了y=0和y=1的代价函数图，从图中可以看出这个代价满足了凸函数的要求且没有局部最优点，只有全局最优点。 </p>
<p><img src="/2019/06/16/机器学习和深度学习算法理论/逻辑回归/损失函数-交叉熵/pic/SouthEast-20190616095853852.png" alt="è¿éåå¾çæè¿°"></p>
<p><a href="https://blog.csdn.net/jasonzzj/article/details/52017438" target="_blank" rel="noopener">交叉熵代价函数(损失函数)及其求导推导</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://schwimmer.github.io/2019/06/16/深度学习笔记/优质git资源/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Schwimmer"/>
      <meta itemprop="description" content="Record and Think!"/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Schwimmer's Blog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/16/深度学习笔记/优质git资源/" class="post-title-link" itemprop="url">未命名</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-16 09:28:33" itemprop="dateCreated datePublished" datetime="2019-06-16T09:28:33+08:00">2019-06-16</time>
            </span>
          

          

          

          
            
            
              
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/06/16/深度学习笔记/优质git资源/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/16/深度学习笔记/优质git资源/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          <br/>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="深度学习500问"><a href="#深度学习500问" class="headerlink" title="深度学习500问"></a>深度学习500问</h1><p>以问答形式对常用的概率知识、线性代数、机器学习、深度学习、计算机视觉等热点问题进行阐述，以帮助自己及有需要的读者。 全书分为18个章节，50余万字。由于水平有限，书中不妥之处恳请广大读者批评指正。</p>
<p><a href="https://github.com/scutan90/DeepLearning-500-questions" target="_blank" rel="noopener">https://github.com/scutan90/DeepLearning-500-questions</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://schwimmer.github.io/2019/06/16/深度学习笔记/Pytorch笔记/Pytorch常见问题/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Schwimmer"/>
      <meta itemprop="description" content="Record and Think!"/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Schwimmer's Blog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/16/深度学习笔记/Pytorch笔记/Pytorch常见问题/" class="post-title-link" itemprop="url">未命名</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-16 09:09:35 / 修改时间：09:10:26" itemprop="dateCreated datePublished" datetime="2019-06-16T09:09:35+08:00">2019-06-16</time>
            </span>
          

          
            

            
          

          

          
            
            
              
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/06/16/深度学习笔记/Pytorch笔记/Pytorch常见问题/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/16/深度学习笔记/Pytorch笔记/Pytorch常见问题/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          <br/>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1、libiomp5-dylib-already-initialized"><a href="#1、libiomp5-dylib-already-initialized" class="headerlink" title="1、libiomp5.dylib already initialized"></a>1、libiomp5.dylib already initialized</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">OMP: Error #15: Initializing libiomp5.dylib, but found libomp.dylib already initialized.</div><div class="line">OMP: Hint This means that multiple copies of the OpenMP runtime have been linked into the program. That is dangerous, since it can degrade performance or cause incorrect results. The best thing to do is to ensure that only a single OpenMP runtime is linked into the process, e.g. by avoiding static linking of the OpenMP runtime in any library. As an unsafe, unsupported, undocumented workaround you can set the environment variable KMP_DUPLICATE_LIB_OK=TRUE to allow the program to continue to execute, but that may cause crashes or silently produce incorrect results. For more information, please see http://www.intel.com/software/products/support/.</div></pre></td></tr></table></figure>
<p>解决方案</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">os.environ[&quot;KMP_DUPLICATE_LIB_OK&quot;]=&quot;TRUE&quot;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://schwimmer.github.io/2019/06/15/深度学习笔记/Pytorch训练营/D5 构建网络模型/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Schwimmer"/>
      <meta itemprop="description" content="Record and Think!"/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Schwimmer's Blog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/15/深度学习笔记/Pytorch训练营/D5 构建网络模型/" class="post-title-link" itemprop="url">未命名</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-15 11:23:22 / 修改时间：11:23:46" itemprop="dateCreated datePublished" datetime="2019-06-15T11:23:22+08:00">2019-06-15</time>
            </span>
          

          
            

            
          

          

          
            
            
              
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/06/15/深度学习笔记/Pytorch训练营/D5 构建网络模型/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/15/深度学习笔记/Pytorch训练营/D5 构建网络模型/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          <br/>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>第二周Day11-Day12</strong> </p>
<p><strong>任务名称</strong>：构建网络模型(包括torch.nn和torch.nn.functional操作[参考文档：(1)pytorch官方文档torch.nn和torch.nn.function(2)PyTorch<em>tutorial_0.0.5</em>余霆嵩文档17~29页)</p>
<p><strong>任务简介</strong>：构建网络模型是学习pytorch框架最重要的内容</p>
<p><strong>详细说明</strong>：</p>
<p>Day11~Day12的任务是构建网络模型，在学习构建网络模型之前需要我们了解官方文档9~10的资料，这里包括了基本的模块，卷积操作、BN操作、池化操作、激活函数等等在构建模型中最基层的方法。学习初期我们可以先学习经典的网络模型，Lenet,Alxnet,Vgg,Resnet等网络模型，后面随着学习的深入自己搭建网络模型或者在经典网络模型的基础上增加或修改其网络，使其达到更好的性能；</p>
<p>Torch.nn.function中的激活函数和池化是我们常用的，一般不使用torch.nn中的激活函数和池化操作，因为网络模型反向传播时不计算池化层的梯度，使用在torch.nn.function中重新封装了部分接口，当然也可以不使用torch.nn.function。</p>
<p>作业资料包下载链接：（学习资料里包含了老师对官方文档的重组文件，前面一周的文档内容也都有更新，对前面内容还有所疑惑的小伙伴可以回头看看文档资料）</p>
<p>链接：<a href="https://pan.baidu.com/s/17xW8rfG-14nu6vc9vjeBlQ" target="_blank" rel="noopener">https://pan.baidu.com/s/17xW8rfG-14nu6vc9vjeBlQ</a> </p>
<p>提取码：34k3 </p>
<p><strong>作业名称（详解）：</strong>（1）手敲官方文档9，10中的基本操作3遍；（2）自己尝试写一个5层的网络模型；</p>
<p><strong>作业提交形式</strong>：打卡提交文字或图片，总结内容不少于20字</p>
<p><strong>打卡截止时间：</strong>6/14</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://schwimmer.github.io/2019/06/14/机器学习和深度学习算法理论/CNN/一些概念/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Schwimmer"/>
      <meta itemprop="description" content="Record and Think!"/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Schwimmer's Blog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/14/机器学习和深度学习算法理论/CNN/一些概念/" class="post-title-link" itemprop="url">未命名</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-14 15:20:21" itemprop="dateCreated datePublished" datetime="2019-06-14T15:20:21+08:00">2019-06-14</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-06-16 09:42:11" itemprop="dateModified" datetime="2019-06-16T09:42:11+08:00">2019-06-16</time>
              </span>
            
          

          

          
            
            
              
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/06/14/机器学习和深度学习算法理论/CNN/一些概念/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/14/机器学习和深度学习算法理论/CNN/一些概念/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          <br/>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="same-padding和valid-padding"><a href="#same-padding和valid-padding" class="headerlink" title="same padding和valid padding"></a>same padding和valid padding</h1><p>首先，padding的含义</p>
<p><a href="https://zhuanlan.zhihu.com/p/36278093" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/36278093</a></p>
<p>padding是增加各个边的pixels的数量，目的是保持feature map 不要太小（不要被卷积越卷越小），但也没必要超过原图的大小，所以不可以任意数量。</p>
<p>padding的上限是维持feature map 大小与原图大小一致，具体增加pixel的数量多少，由filter的尺寸和stride大小共同决定；</p>
<p><strong>padding 存在的意义在于</strong></p>
<blockquote>
<p>为了不丢弃原图信息<br>为了保持feature map 的大小与原图一致<br>为了让更深层的layer的input依旧保持有足够大的信息量<br>为了实现上述目的，且不做多余的事情，padding出来的pixel的值都是0，不存在噪音问题</p>
</blockquote>
<h1 id="计算输出尺寸"><a href="#计算输出尺寸" class="headerlink" title="计算输出尺寸"></a>计算输出尺寸</h1><ol>
<li><p>过滤器数量-输出卷的深度与过滤器的数量成正比。请记住该如何堆叠每个过滤器的输出以形成激活映射。激活图的深度等于过滤器的数量。</p>
</li>
<li><p>步幅（Stride）-如果步幅是 1，那么我们处理图片的精细度就进入单像素级别了。更高的步幅意味着同时处理更多的像素，从而产生较小的输出量。</p>
</li>
<li><p>零填充（zero padding）-这有助于我们保留输入图像的尺寸。如果添加了单零填充，则单步幅过滤器的运动会保持在原图尺寸。</p>
</li>
</ol>
<p>我们可以应用一个简单的公式来计算输出尺寸。输出图像的空间尺寸可以计算为（[W-F + 2P] / S）+1。在这里，W 是输入尺寸，F 是过滤器的尺寸，P 是填充数量，S 是步幅数字。假如我们有一张<code>32*32*3</code> 的输入图像，我们使用 10 个尺寸为<code>3*3*3</code>的过滤器，单步幅和零填充。</p>
<p>那么 W=32，F=3，P=0，S=1。输出深度等于应用的滤波器的数量，即 10，输出尺寸大小为<code>([32-3+0]/1)+1 = 30</code>。因此输出尺寸是 <code>30*30*10</code>。</p>
<h1 id="卷积核相关概念"><a href="#卷积核相关概念" class="headerlink" title="卷积核相关概念"></a>卷积核相关概念</h1><p>如Pytorch中，conv1.weight.shape() = [6,3,5,5]，输入通道数为 3，卷积核个数为 6，则 feature map 数为 6，卷积核大小为 5*5。</p>
<p>这些概念分别代表什么</p>
<h2 id="通道数"><a href="#通道数" class="headerlink" title="通道数"></a>通道数</h2><p><a href="https://blog.csdn.net/sscc_learning/article/details/79814146" target="_blank" rel="noopener">【CNN】理解卷积神经网络中的通道 channel</a></p>
<p> <a href="https://www.tensorflow.org/tutorials/layers" target="_blank" rel="noopener">tensorflow</a> 中给出的，对于输入样本中 <code>channels</code> 的含义。一般的RGB图片，<code>channels</code>数量是 3 （红、绿、蓝）；而monochrome图片，<code>channels</code> 数量是 1 。</p>
<h2 id="特征图feature-map"><a href="#特征图feature-map" class="headerlink" title="特征图feature map"></a>特征图feature map</h2>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Schwimmer</p>
              <div class="site-description motion-element" itemprop="description">Record and Think!</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">313</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">20</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">56</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Schwimmer</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.5.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.2.0</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="总访客量">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="总访问量">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.2.0"></script>

  <script src="/js/motion.js?v=7.2.0"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.2.0"></script>




  

  


  <script src="/js/next-boot.js?v=7.2.0"></script>


  

  

  

  
  
<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://https-schwimmer-github-io.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>







  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
    
      <script type="text/x-mathjax-config">
  

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });
  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') { next = next.nextSibling }
        if (next && next.nodeName.toLowerCase() === 'br') { next.parentNode.removeChild(next) }
      }
    });
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      document.getElementById(all[i].inputID + '-Frame').parentNode.className += ' has-jax';
    }
  });
</script>
<script src="//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

    
  


  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
